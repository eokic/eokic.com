---
// TYPES
import type { IGlobal, IHome, ITestimonial } from '@/interfaces'

// METHODS
import fetchApi from '@/lib/strapi'

// COMPONENTS
// import { Debug } from 'astro/components'
import { BaseLayout } from '@/layouts'
import { Hero } from '@/components/home'
import { Section, ServiceTeaser, Testimonial } from '@/components'

const globals = await fetchApi<IGlobal>({
  endpoint: 'global',
  query: { populate: 'deep' },
  wrappedByKey: 'data',
})

const home = await fetchApi<IHome>({
  endpoint: 'home',
  query: { populate: 'deep' },
  wrappedByKey: 'data',
})

const testimonials = await fetchApi<ITestimonial[]>({
  endpoint: 'testimonials',
  query: { populate: 'deep' },
  wrappedByKey: 'data',
})
---

<BaseLayout title="Welcome to Astro.">
  <main class="main">
    <Hero {globals} {home} />

    <Section
      id="services"
      title={home?.sectionServices?.title}
      subtitle={home?.sectionServices?.subtitle}
      alt
    >
      <div class="columns-1 md:columns-3 gap-5">
        {home.services?.map((service) => <ServiceTeaser {service} />)}
      </div>
    </Section>

    <Section
      id="work"
      title={home?.sectionWork?.title}
      subtitle={home?.sectionWork?.subtitle}
    >
      <div class="grid grid-cols-3 gap-5">
        {testimonials?.map((testimonial) => <Testimonial {testimonial} />)}
      </div>
    </Section>

    <Section
      id="about"
      title={home?.sectionAbout?.title}
      subtitle={home?.sectionAbout?.subtitle}
      alt
    >
      TODO: ABOUT
    </Section>
  </main>
</BaseLayout>
